`Retina Network Security Scanner` is a vulnerability management tool used to identify and assess vulnerabilities within networks and systems. Below is a guide to interacting with Retina Network Security Scanner using its command-line interface (CLI) and API, including options and examples.

### **Retina Network Security Scanner Shell Commands and API Options**

#### **1. CLI Commands**

**Retina Network Security Scanner** doesnâ€™t have as extensive a CLI as some other tools, but it does provide several command-line options for managing scans and reports.

1. **Start a Scan:**
   - **Description:** Initiate a network scan.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --start-scan --scan-name <scan_name> --target <target> --profile <profile>
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --start-scan --scan-name "Test Scan" --target "192.168.1.1" --profile "Full Scan"
     ```

2. **Stop a Scan:**
   - **Description:** Stop a running scan.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --stop-scan --scan-id <scan_id>
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --stop-scan --scan-id 12345
     ```

3. **View Scan Status:**
   - **Description:** Check the status of a scan.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --scan-status --scan-id <scan_id>
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --scan-status --scan-id 12345
     ```

4. **Generate a Report:**
   - **Description:** Generate a report from scan results.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --generate-report --scan-id <scan_id> --format <format>
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --generate-report --scan-id 12345 --format pdf
     ```

5. **List Available Scans:**
   - **Description:** List all scans.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --list-scans
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --list-scans
     ```

6. **List Scan Profiles:**
   - **Description:** List all scan profiles available.
   - **Command:**
     ```bash
     /opt/retina/bin/retina_scanner --list-profiles
     ```
   - **Example:**
     ```bash
     /opt/retina/bin/retina_scanner --list-profiles
     ```

#### **2. API Interaction**

**Retina Network Security Scanner** typically interacts through its REST API for more advanced automation and integration.

1. **Authenticate with API:**
   - **Description:** Obtain an API token or session for authentication.
   - **Command:**
     ```bash
     curl -X POST "https://<retina_host>/api/v1/auth/login" -d '{"username":"<username>","password":"<password>"}' -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://retina.example.com/api/v1/auth/login" -d '{"username":"admin","password":"password"}' -H "Content-Type: application/json"
     ```

2. **Start a Scan:**
   - **Description:** Initiate a scan via API.
   - **Command:**
     ```bash
     curl -X POST "https://<retina_host>/api/v1/scans" -d '{"name":"<scan_name>","targets":["<target>"],"profile":"<profile>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://retina.example.com/api/v1/scans" -d '{"name":"Test Scan","targets":["192.168.1.1"],"profile":"Full Scan"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

3. **Stop a Scan:**
   - **Description:** Stop a running scan by its ID.
   - **Command:**
     ```bash
     curl -X POST "https://<retina_host>/api/v1/scans/<scan_id>/stop" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://retina.example.com/api/v1/scans/12345/stop" -H "Authorization: Bearer <your_api_token>"
     ```

4. **Get Scan Status:**
   - **Description:** Retrieve the status of a scan.
   - **Command:**
     ```bash
     curl -X GET "https://<retina_host>/api/v1/scans/<scan_id>" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://retina.example.com/api/v1/scans/12345" -H "Authorization: Bearer <your_api_token>"
     ```

5. **Generate Scan Report:**
   - **Description:** Generate a report from scan results.
   - **Command:**
     ```bash
     curl -X POST "https://<retina_host>/api/v1/reports" -d '{"scan_id":"<scan_id>","format":"<format>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://retina.example.com/api/v1/reports" -d '{"scan_id":"12345","format":"pdf"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

6. **List Scan Profiles:**
   - **Description:** Retrieve a list of scan profiles.
   - **Command:**
     ```bash
     curl -X GET "https://<retina_host>/api/v1/profiles" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://retina.example.com/api/v1/profiles" -H "Authorization: Bearer <your_api_token>"
     ```

7. **List All Scans:**
   - **Description:** Get a list of all scans.
   - **Command:**
     ```bash
     curl -X GET "https://<retina_host>/api/v1/scans" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://retina.example.com/api/v1/scans" -H "Authorization: Bearer <your_api_token>"
     ```

### **Usage Notes**

- **Permissions:** Ensure you have appropriate permissions to perform operations such as starting, stopping, and generating reports.
- **API Documentation:** Consult the official Retina/InsightVM API documentation for detailed information on endpoints and usage.
- **Security:** Handle API tokens securely and avoid exposing them in logs or public repositories.