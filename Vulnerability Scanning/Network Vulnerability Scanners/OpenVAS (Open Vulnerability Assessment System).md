Hereâ€™s a detailed guide for using `OpenVAS` (Open Vulnerability Assessment System) from the shell, including commands, options, and examples. OpenVAS is an open-source vulnerability scanner that provides comprehensive network vulnerability assessment.

### **OpenVAS Shell Commands and Options**

#### **1. Starting and Stopping Services:**

1. **Start OpenVAS Services:**
   - **Description:** Start the necessary OpenVAS services.
   - **Command:**
     ```bash
     sudo gvm-start
     ```
   - **Example:**
     ```bash
     sudo gvm-start
     ```

2. **Stop OpenVAS Services:**
   - **Description:** Stop the OpenVAS services.
   - **Command:**
     ```bash
     sudo gvm-stop
     ```
   - **Example:**
     ```bash
     sudo gvm-stop
     ```

3. **Check OpenVAS Service Status:**
   - **Description:** Check the status of OpenVAS services.
   - **Command:**
     ```bash
     sudo gvm-check-setup
     ```
   - **Example:**
     ```bash
     sudo gvm-check-setup
     ```

#### **2. OpenVAS Scanner Commands:**

1. **Update the OpenVAS Feed:**
   - **Description:** Update the vulnerability database and feeds.
   - **Command:**
     ```bash
     sudo greenbone-nvt-sync
     ```
   - **Example:**
     ```bash
     sudo greenbone-nvt-sync
     ```

2. **Update OpenVAS Certificates:**
   - **Description:** Update the SSL certificates used by OpenVAS.
   - **Command:**
     ```bash
     sudo gvm-manage-certs -a
     ```
   - **Example:**
     ```bash
     sudo gvm-manage-certs -a
     ```

3. **List Available Scan Configurations:**
   - **Description:** List all scan configurations available in OpenVAS.
   - **Command:**
     ```bash
     omp -G
     ```
   - **Example:**
     ```bash
     omp -G
     ```

4. **Create a New Scan Task:**
   - **Description:** Create a new scan task with a specific configuration.
   - **Command:**
     ```bash
     omp -T -t <task_name> -d <description> -c <config_id> -H <target_id>
     ```
   - **Example:**
     ```bash
     omp -T -t "My Scan" -d "Scan of the internal network" -c 1 -H 1
     ```

5. **Start a Scan Task:**
   - **Description:** Start a scan task by its ID.
   - **Command:**
     ```bash
     omp -S <task_id>
     ```
   - **Example:**
     ```bash
     omp -S 1
     ```

6. **Stop a Scan Task:**
   - **Description:** Stop a running scan task by its ID.
   - **Command:**
     ```bash
     omp -s <task_id>
     ```
   - **Example:**
     ```bash
     omp -s 1
     ```

7. **List All Scan Tasks:**
   - **Description:** List all scan tasks and their statuses.
   - **Command:**
     ```bash
     omp -l
     ```
   - **Example:**
     ```bash
     omp -l
     ```

8. **Get Scan Report:**
   - **Description:** Retrieve the report for a completed scan.
   - **Command:**
     ```bash
     omp -R <report_id>
     ```
   - **Example:**
     ```bash
     omp -R 1
     ```

9. **Export Scan Report:**
   - **Description:** Export the scan report in a specific format.
   - **Command:**
     ```bash
     omp -R <report_id> -f <format> -o <output_file>
     ```
   - **Example:**
     ```bash
     omp -R 1 -f PDF -o report.pdf
     ```

#### **3. OpenVAS Management Commands:**

1. **Create a New Target:**
   - **Description:** Create a new target to scan.
   - **Command:**
     ```bash
     omp -T -t <target_name> -i <target_ip>
     ```
   - **Example:**
     ```bash
     omp -T -t "Internal Network" -i 192.168.1.1
     ```

2. **List All Targets:**
   - **Description:** List all targets configured in OpenVAS.
   - **Command:**
     ```bash
     omp -T
     ```
   - **Example:**
     ```bash
     omp -T
     ```

3. **Create a New Scan Config:**
   - **Description:** Create a new scan configuration.
   - **Command:**
     ```bash
     omp -C -n <config_name> -d <description>
     ```
   - **Example:**
     ```bash
     omp -C -n "Full Scan" -d "Complete network scan"
     ```

4. **List Available Scan Configs:**
   - **Description:** List all scan configurations available in OpenVAS.
   - **Command:**
     ```bash
     omp -C
     ```
   - **Example:**
     ```bash
     omp -C
     ```

#### **4. Troubleshooting and Status Commands:**

1. **Check for Missing Dependencies:**
   - **Description:** Check for missing dependencies and configurations.
   - **Command:**
     ```bash
     sudo gvm-check-setup
     ```
   - **Example:**
     ```bash
     sudo gvm-check-setup
     ```

2. **Display Logs:**
   - **Description:** Display logs for troubleshooting.
   - **Command:**
     ```bash
     sudo tail -f /var/log/gvm/*.log
     ```
   - **Example:**
     ```bash
     sudo tail -f /var/log/gvm/gsad.log
     ```

### **Installation and Setup**

1. **Install OpenVAS:**
   - **Description:** Install OpenVAS on your system.
   - **Command:**
     ```bash
     sudo apt-get install openvas
     ```
   - **Example:**
     ```bash
     sudo apt-get install openvas
     ```

2. **Initialize OpenVAS:**
   - **Description:** Set up and initialize OpenVAS for the first time.
   - **Command:**
     ```bash
     sudo openvas-setup
     ```
   - **Example:**
     ```bash
     sudo openvas-setup
     ```

3. **Update Feeds:**
   - **Description:** Update the vulnerability feeds.
   - **Command:**
     ```bash
     sudo greenbone-nvt-sync
     ```
   - **Example:**
     ```bash
     sudo greenbone-nvt-sync
     ```

### **Usage Notes**

- **Permissions:** Many commands require `sudo` privileges for execution.
- **Configuration:** Ensure that OpenVAS is properly configured and that all necessary services are running.
- **API Interaction:** For API-based interactions, you may use `gvm-cli` or `gvm-tools` to script and automate interactions.