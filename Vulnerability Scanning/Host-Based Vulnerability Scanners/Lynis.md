`Lynis` is a security auditing tool for Unix-based systems such as Linux, macOS, and BSD. It helps identify security issues, hardening suggestions, and vulnerabilities. Below is a guide for using Lynis via its CLI commands.

### **Lynis CLI Commands and Options**

#### **1. Basic Commands**

1. **Run a Full System Audit:**
   - **Description:** This command runs a complete system audit.
   - **Command:**
     ```bash
     lynis audit system
     ```
   - **Example:**
     ```bash
     sudo lynis audit system
     ```

2. **Perform Specific Audit (e.g., Kernel):**
   - **Description:** Audit only specific components, such as the kernel, to minimize time and target certain areas.
   - **Command:**
     ```bash
     lynis audit system --tests-from-group <group>
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --tests-from-group "kernel"
     ```

3. **Audit Docker Containers:**
   - **Description:** Scan Docker containers for vulnerabilities or misconfigurations.
   - **Command:**
     ```bash
     lynis audit docker
     ```
   - **Example:**
     ```bash
     sudo lynis audit docker
     ```

4. **View Installed Plugins:**
   - **Description:** List all plugins available and check for installed ones.
   - **Command:**
     ```bash
     lynis show plugins
     ```
   - **Example:**
     ```bash
     lynis show plugins
     ```

5. **Check Lynis Version:**
   - **Description:** Display the version of Lynis installed on the system.
   - **Command:**
     ```bash
     lynis show version
     ```
   - **Example:**
     ```bash
     lynis show version
     ```

6. **List Available Tests:**
   - **Description:** Show the tests that can be performed by Lynis.
   - **Command:**
     ```bash
     lynis show tests
     ```
   - **Example:**
     ```bash
     lynis show tests
     ```

7. **Show Available Categories:**
   - **Description:** Display the list of categories (test groups) that Lynis can scan.
   - **Command:**
     ```bash
     lynis show categories
     ```
   - **Example:**
     ```bash
     lynis show categories
     ```

#### **2. Specific Audit Areas**

1. **Audit a Single File or Directory:**
   - **Description:** Audit a specific file or directory.
   - **Command:**
     ```bash
     lynis audit file <file_path>
     ```
   - **Example:**
     ```bash
     sudo lynis audit file /etc/passwd
     ```

2. **Audit Networking Components:**
   - **Description:** Perform an audit focused on networking.
   - **Command:**
     ```bash
     lynis audit system --tests-from-group "networking"
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --tests-from-group "networking"
     ```

3. **Audit Security Frameworks (e.g., AppArmor, SELinux):**
   - **Description:** Focus specifically on security frameworks in the system.
   - **Command:**
     ```bash
     lynis audit system --tests-from-group "securityframeworks"
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --tests-from-group "securityframeworks"
     ```

#### **3. Report and Logging Options**

1. **Custom Log Location:**
   - **Description:** Specify a custom log file for the audit results.
   - **Command:**
     ```bash
     lynis audit system --log-file <file_path>
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --log-file /var/log/lynis_audit.log
     ```

2. **Create a Report:**
   - **Description:** Generate a detailed report of the audit.
   - **Command:**
     ```bash
     lynis audit system --report-file <file_path>
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --report-file /var/log/lynis_report.txt
     ```

3. **Quiet Mode:**
   - **Description:** Run Lynis without output to the terminal (quiet mode).
   - **Command:**
     ```bash
     lynis audit system --quiet
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --quiet
     ```

4. **Enable Debug Logging:**
   - **Description:** Enable detailed logging for debugging purposes.
   - **Command:**
     ```bash
     lynis audit system --debug
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --debug
     ```

#### **4. Advanced Options**

1. **Run in Test Mode (No Changes):**
   - **Description:** Perform an audit without making any changes to the system, for testing purposes.
   - **Command:**
     ```bash
     lynis audit system --test
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --test
     ```

2. **Enable Custom Test Groups:**
   - **Description:** Run tests for custom test groups.
   - **Command:**
     ```bash
     lynis audit system --tests-from-group "<custom_group>"
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --tests-from-group "databases"
     ```

3. **Specify No-Color Output:**
   - **Description:** Disable color in output, useful for logging or piping.
   - **Command:**
     ```bash
     lynis audit system --no-color
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --no-color
     ```

4. **Specify Hardening Level:**
   - **Description:** Choose the level of system hardening to apply.
   - **Command:**
     ```bash
     lynis audit system --hardening-level <level>
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --hardening-level "paranoid"
     ```

#### **5. Automation & Integration**

1. **Cron Job for Regular Audits:**
   - **Description:** Automate regular system audits by scheduling Lynis via a cron job.
   - **Command:**
     ```bash
     sudo crontab -e
     ```
   - **Example (inside cron job):**
     ```bash
     0 3 * * 1 /usr/local/bin/lynis audit system --quiet >> /var/log/lynis_cron.log
     ```

2. **Integration with Central Logging:**
   - **Description:** Send audit logs to a centralized logging system like Syslog.
   - **Command:**
     ```bash
     lynis audit system --cronjob --log-to-syslog
     ```
   - **Example:**
     ```bash
     sudo lynis audit system --cronjob --log-to-syslog
     ```

#### **Usage Notes:**
- **Privileges:** Most Lynis commands require `sudo` to execute properly, as many security checks need elevated privileges.
- **Logs and Reports:** Always review the logs and reports generated by Lynis for detailed information on security findings and recommendations for hardening.
- **Documentation:** For more options and detailed usage, consult [Lynis documentation](https://cisofy.com/documentation/lynis/) or run `lynis --help`.

