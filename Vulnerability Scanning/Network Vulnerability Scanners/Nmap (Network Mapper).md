`Nmap` (Network Mapper) is a powerful open-source tool for network discovery and security auditing. It is commonly used for network inventory, managing service upgrade schedules, and monitoring host or service uptime. Below is a comprehensive guide to `Nmap` shell commands, options, and examples.

### **Nmap Shell Commands and Options**

#### **1. Basic Scanning**

1. **Scan a Single Host:**
   - **Description:** Perform a basic scan on a single host.
   - **Command:**
     ```bash
     nmap <target>
     ```
   - **Example:**
     ```bash
     nmap 192.168.1.1
     ```

2. **Scan Multiple Hosts:**
   - **Description:** Scan multiple hosts or a subnet.
   - **Command:**
     ```bash
     nmap <target1> <target2> <target3>
     ```
   - **Example:**
     ```bash
     nmap 192.168.1.1 192.168.1.2
     ```

3. **Scan a Range of IP Addresses:**
   - **Description:** Scan a range of IP addresses.
   - **Command:**
     ```bash
     nmap <start_ip>-<end_ip>
     ```
   - **Example:**
     ```bash
     nmap 192.168.1.1-50
     ```

4. **Scan an Entire Subnet:**
   - **Description:** Scan an entire subnet.
   - **Command:**
     ```bash
     nmap <subnet>/<mask>
     ```
   - **Example:**
     ```bash
     nmap 192.168.1.0/24
     ```

#### **2. Port Scanning**

1. **Scan Specific Ports:**
   - **Description:** Scan specific ports on a target.
   - **Command:**
     ```bash
     nmap -p <port1,port2,...> <target>
     ```
   - **Example:**
     ```bash
     nmap -p 22,80,443 192.168.1.1
     ```

2. **Scan a Range of Ports:**
   - **Description:** Scan a range of ports.
   - **Command:**
     ```bash
     nmap -p <start_port>-<end_port> <target>
     ```
   - **Example:**
     ```bash
     nmap -p 1-1000 192.168.1.1
     ```

3. **Scan All Ports:**
   - **Description:** Scan all 65535 ports.
   - **Command:**
     ```bash
     nmap -p- <target>
     ```
   - **Example:**
     ```bash
     nmap -p- 192.168.1.1
     ```

#### **3. Service and Version Detection**

1. **Detect Services and Versions:**
   - **Description:** Detect services and versions running on open ports.
   - **Command:**
     ```bash
     nmap -sV <target>
     ```
   - **Example:**
     ```bash
     nmap -sV 192.168.1.1
     ```

2. **Detect Operating System:**
   - **Description:** Attempt to detect the operating system of the target.
   - **Command:**
     ```bash
     nmap -O <target>
     ```
   - **Example:**
     ```bash
     nmap -O 192.168.1.1
     ```

3. **Detect OS and Services:**
   - **Description:** Perform OS detection and service/version detection.
   - **Command:**
     ```bash
     nmap -A <target>
     ```
   - **Example:**
     ```bash
     nmap -A 192.168.1.1
     ```

#### **4. Network Scanning**

1. **Ping Scan (Find Live Hosts):**
   - **Description:** Ping scan to discover live hosts without performing a port scan.
   - **Command:**
     ```bash
     nmap -sn <target>
     ```
   - **Example:**
     ```bash
     nmap -sn 192.168.1.0/24
     ```

2. **Perform a TCP Connect Scan:**
   - **Description:** Scan using TCP connect() method (default).
   - **Command:**
     ```bash
     nmap -sT <target>
     ```
   - **Example:**
     ```bash
     nmap -sT 192.168.1.1
     ```

3. **Perform a SYN Scan:**
   - **Description:** Perform a stealth SYN scan.
   - **Command:**
     ```bash
     nmap -sS <target>
     ```
   - **Example:**
     ```bash
     nmap -sS 192.168.1.1
     ```

4. **Perform a UDP Scan:**
   - **Description:** Scan UDP ports.
   - **Command:**
     ```bash
     nmap -sU <target>
     ```
   - **Example:**
     ```bash
     nmap -sU 192.168.1.1
     ```

#### **5. Output Options**

1. **Save Output to File:**
   - **Description:** Save the scan results to a file in different formats.
   - **Command:**
     ```bash
     nmap -oN <file> <target>
     ```
   - **Example:**
     ```bash
     nmap -oN scan_results.txt 192.168.1.1
     ```

2. **Save Output in XML Format:**
   - **Description:** Save the output in XML format.
   - **Command:**
     ```bash
     nmap -oX <file> <target>
     ```
   - **Example:**
     ```bash
     nmap -oX scan_results.xml 192.168.1.1
     ```

3. **Save Output in Grepable Format:**
   - **Description:** Save output in grepable format.
   - **Command:**
     ```bash
     nmap -oG <file> <target>
     ```
   - **Example:**
     ```bash
     nmap -oG scan_results.grep 192.168.1.1
     ```

4. **Save Output in All Formats:**
   - **Description:** Save output in all available formats.
   - **Command:**
     ```bash
     nmap -oA <basename> <target>
     ```
   - **Example:**
     ```bash
     nmap -oA scan_results 192.168.1.1
     ```

#### **6. Advanced Scanning**

1. **Perform a TCP ACK Scan:**
   - **Description:** Scan to map firewall rules and determine if ports are filtered.
   - **Command:**
     ```bash
     nmap -sA <target>
     ```
   - **Example:**
     ```bash
     nmap -sA 192.168.1.1
     ```

2. **Perform a Xmas Scan:**
   - **Description:** Scan with TCP Xmas packets to determine if ports are open.
   - **Command:**
     ```bash
     nmap -sX <target>
     ```
   - **Example:**
     ```bash
     nmap -sX 192.168.1.1
     ```

3. **Perform a Null Scan:**
   - **Description:** Scan with TCP Null packets to detect open ports.
   - **Command:**
     ```bash
     nmap -sN <target>
     ```
   - **Example:**
     ```bash
     nmap -sN 192.168.1.1
     ```

4. **Scan with a Specific Timing Template:**
   - **Description:** Control scan speed and stealthiness.
   - **Command:**
     ```bash
     nmap -T<0-5> <target>
     ```
   - **Example:**
     ```bash
     nmap -T4 192.168.1.1
     ```

#### **7. Scripting and Automation**

1. **Run Nmap Scripts:**
   - **Description:** Run Nmap Scripting Engine (NSE) scripts.
   - **Command:**
     ```bash
     nmap --script <script_name> <target>
     ```
   - **Example:**
     ```bash
     nmap --script http-vuln-cve2014-3704 192.168.1.1
     ```

2. **Run All Available Scripts:**
   - **Description:** Execute all available NSE scripts.
   - **Command:**
     ```bash
     nmap --script all <target>
     ```
   - **Example:**
     ```bash
     nmap --script all 192.168.1.1
     ```

3. **Specify a Script Category:**
   - **Description:** Run scripts from a specific category.
   - **Command:**
     ```bash
     nmap --script <category> <target>
     ```
   - **Example:**
     ```bash
     nmap --script vuln 192.168.1.1
     ```

### **Usage Notes**

- **Permissions:** Some scans, especially those requiring root privileges, might need to be run with `sudo`.
- **Firewall/IDS:** Be cautious with aggressive scans as they can trigger alerts in intrusion detection systems (IDS) or firewalls.
- **API Integration:** Nmap also has an

 XML output option that can be parsed by scripts or programs for automated processing.