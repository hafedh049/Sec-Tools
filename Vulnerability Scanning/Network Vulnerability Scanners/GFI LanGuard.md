`GFI LanGuard` is a network security scanner and vulnerability assessment tool. It provides comprehensive network and vulnerability scanning capabilities. Below is a guide for interacting with GFI LanGuard using its command-line interface (CLI) and API, including options and examples.

### **GFI LanGuard CLI Commands and API Options**

#### **1. CLI Commands**

GFI LanGuard has a more limited CLI compared to some other tools, but it does support several command-line options for managing scans and reports.

1. **Start a Scan:**
   - **Description:** Initiate a network scan.
   - **Command:**
     ```bash
     languardcmd /startscan /target=<target> /profile=<profile> /scanname=<scan_name>
     ```
   - **Example:**
     ```bash
     languardcmd /startscan /target=192.168.1.1 /profile=FullScan /scanname="TestScan"
     ```

2. **Stop a Scan:**
   - **Description:** Stop a running scan.
   - **Command:**
     ```bash
     languardcmd /stopscan /scanid=<scan_id>
     ```
   - **Example:**
     ```bash
     languardcmd /stopscan /scanid=12345
     ```

3. **View Scan Status:**
   - **Description:** Check the status of a scan.
   - **Command:**
     ```bash
     languardcmd /scanstatus /scanid=<scan_id>
     ```
   - **Example:**
     ```bash
     languardcmd /scanstatus /scanid=12345
     ```

4. **Generate a Report:**
   - **Description:** Generate a report from scan results.
   - **Command:**
     ```bash
     languardcmd /report /scanid=<scan_id> /format=<format>
     ```
   - **Example:**
     ```bash
     languardcmd /report /scanid=12345 /format=pdf
     ```

5. **List Available Scans:**
   - **Description:** List all scans.
   - **Command:**
     ```bash
     languardcmd /listscans
     ```
   - **Example:**
     ```bash
     languardcmd /listscans
     ```

6. **List Scan Profiles:**
   - **Description:** List all scan profiles available.
   - **Command:**
     ```bash
     languardcmd /listprofiles
     ```
   - **Example:**
     ```bash
     languardcmd /listprofiles
     ```

#### **2. API Interaction**

GFI LanGuard provides API access for more advanced automation and integration. The API allows you to manage scans, retrieve scan results, and more.

1. **Authenticate with API:**
   - **Description:** Obtain an API token for authentication.
   - **Command:**
     ```bash
     curl -X POST "https://<gfi_languard_host>/api/v1/auth/login" -d '{"username":"<username>","password":"<password>"}' -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://gfilanguard.example.com/api/v1/auth/login" -d '{"username":"admin","password":"password"}' -H "Content-Type: application/json"
     ```

2. **Start a Scan:**
   - **Description:** Initiate a scan via API.
   - **Command:**
     ```bash
     curl -X POST "https://<gfi_languard_host>/api/v1/scans" -d '{"name":"<scan_name>","targets":["<target>"],"profile":"<profile>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://gfilanguard.example.com/api/v1/scans" -d '{"name":"Test Scan","targets":["192.168.1.1"],"profile":"Full Scan"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

3. **Stop a Scan:**
   - **Description:** Stop a running scan by its ID.
   - **Command:**
     ```bash
     curl -X POST "https://<gfi_languard_host>/api/v1/scans/<scan_id>/stop" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://gfilanguard.example.com/api/v1/scans/12345/stop" -H "Authorization: Bearer <your_api_token>"
     ```

4. **Get Scan Status:**
   - **Description:** Retrieve the status of a scan.
   - **Command:**
     ```bash
     curl -X GET "https://<gfi_languard_host>/api/v1/scans/<scan_id>" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://gfilanguard.example.com/api/v1/scans/12345" -H "Authorization: Bearer <your_api_token>"
     ```

5. **Generate Scan Report:**
   - **Description:** Generate a report from scan results.
   - **Command:**
     ```bash
     curl -X POST "https://<gfi_languard_host>/api/v1/reports" -d '{"scan_id":"<scan_id>","format":"<format>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://gfilanguard.example.com/api/v1/reports" -d '{"scan_id":"12345","format":"pdf"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

6. **List Scan Profiles:**
   - **Description:** Retrieve a list of scan profiles.
   - **Command:**
     ```bash
     curl -X GET "https://<gfi_languard_host>/api/v1/profiles" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://gfilanguard.example.com/api/v1/profiles" -H "Authorization: Bearer <your_api_token>"
     ```

7. **List All Scans:**
   - **Description:** Get a list of all scans.
   - **Command:**
     ```bash
     curl -X GET "https://<gfi_languard_host>/api/v1/scans" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://gfilanguard.example.com/api/v1/scans" -H "Authorization: Bearer <your_api_token>"
     ```

### **Usage Notes**

- **Permissions:** Ensure you have appropriate permissions to start scans, stop scans, and generate reports.
- **API Documentation:** Refer to the official GFI LanGuard API documentation for detailed information on endpoints and usage.
- **Security:** Handle API tokens securely to prevent unauthorized access.