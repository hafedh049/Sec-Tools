`Netsparker` is a web application security scanner that automates the process of finding vulnerabilities in web applications. It offers both a GUI and a command-line interface for automation. Below is a guide for interacting with Netsparker using CLI commands and its API.

### **Netsparker CLI Commands and API Options**

#### **1. CLI Commands**

Netsparker offers command-line functionality primarily through its `Netsparker Enterprise` and `Netsparker Cloud` editions. Commands are generally executed via PowerShell or Command Prompt on Windows.

1. **Start a Scan:**
   - **Description:** Start a scan using the Netsparker CLI.
   - **Command:**
     ```bash
     netsparkercli.exe -start -url <target_url> -profile <scan_profile> -apikey <api_key>
     ```
   - **Example:**
     ```bash
     netsparkercli.exe -start -url http://example.com -profile "Full Scan" -apikey 1234567890abcdef
     ```

2. **Get Scan Status:**
   - **Description:** Retrieve the status of an ongoing scan.
   - **Command:**
     ```bash
     netsparkercli.exe -status -scanid <scan_id> -apikey <api_key>
     ```
   - **Example:**
     ```bash
     netsparkercli.exe -status -scanid 12345 -apikey 1234567890abcdef
     ```

3. **Stop a Scan:**
   - **Description:** Stop an ongoing scan.
   - **Command:**
     ```bash
     netsparkercli.exe -stop -scanid <scan_id> -apikey <api_key>
     ```
   - **Example:**
     ```bash
     netsparkercli.exe -stop -scanid 12345 -apikey 1234567890abcdef
     ```

4. **Generate a Report:**
   - **Description:** Generate a report from the scan results.
   - **Command:**
     ```bash
     netsparkercli.exe -report -scanid <scan_id> -format <report_format> -output <output_file> -apikey <api_key>
     ```
   - **Example:**
     ```bash
     netsparkercli.exe -report -scanid 12345 -format pdf -output report.pdf -apikey 1234567890abcdef
     ```

5. **List Scans:**
   - **Description:** List all scans.
   - **Command:**
     ```bash
     netsparkercli.exe -list-scans -apikey <api_key>
     ```
   - **Example:**
     ```bash
     netsparkercli.exe -list-scans -apikey 1234567890abcdef
     ```

#### **2. API Interaction**

Netsparker provides a REST API for automating various tasks. Below are some examples of common API interactions.

1. **Authenticate with API:**
   - **Description:** Obtain an API token for authentication.
   - **Command:**
     ```bash
     curl -X POST "https://<netsparker_host>/api/v1/authenticate" -d '{"username":"<username>","password":"<password>"}' -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://netsparker.example.com/api/v1/authenticate" -d '{"username":"admin","password":"password"}' -H "Content-Type: application/json"
     ```

2. **Start a Scan:**
   - **Description:** Start a scan on a target URL.
   - **Command:**
     ```bash
     curl -X POST "https://<netsparker_host>/api/v1/scans" -d '{"target":"<target_url>","profile":"<scan_profile>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://netsparker.example.com/api/v1/scans" -d '{"target":"http://example.com","profile":"Full Scan"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

3. **Get Scan Status:**
   - **Description:** Retrieve the status of an ongoing scan.
   - **Command:**
     ```bash
     curl -X GET "https://<netsparker_host>/api/v1/scans/<scan_id>" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://netsparker.example.com/api/v1/scans/12345" -H "Authorization: Bearer <your_api_token>"
     ```

4. **Get Scan Results:**
   - **Description:** Retrieve results from a completed scan.
   - **Command:**
     ```bash
     curl -X GET "https://<netsparker_host>/api/v1/scans/<scan_id>/results" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://netsparker.example.com/api/v1/scans/12345/results" -H "Authorization: Bearer <your_api_token>"
     ```

5. **Generate a Report:**
   - **Description:** Generate a report from scan results.
   - **Command:**
     ```bash
     curl -X POST "https://<netsparker_host>/api/v1/reports" -d '{"scan_id":"<scan_id>","format":"<report_format>"}' -H "Authorization: Bearer <api_token>" -H "Content-Type: application/json"
     ```
   - **Example:**
     ```bash
     curl -X POST "https://netsparker.example.com/api/v1/reports" -d '{"scan_id":"12345","format":"pdf"}' -H "Authorization: Bearer <your_api_token>" -H "Content-Type: application/json"
     ```

6. **List All Scans:**
   - **Description:** Retrieve a list of all scans.
   - **Command:**
     ```bash
     curl -X GET "https://<netsparker_host>/api/v1/scans" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://netsparker.example.com/api/v1/scans" -H "Authorization: Bearer <your_api_token>"
     ```

7. **List Scan Profiles:**
   - **Description:** Retrieve a list of available scan profiles.
   - **Command:**
     ```bash
     curl -X GET "https://<netsparker_host>/api/v1/profiles" -H "Authorization: Bearer <api_token>"
     ```
   - **Example:**
     ```bash
     curl -X GET "https://netsparker.example.com/api/v1/profiles" -H "Authorization: Bearer <your_api_token>"
     ```

### **Usage Notes**

- **API Key:** Replace `<api_token>` with your API key or authentication token for authorized requests.
- **API Documentation:** Refer to the [Netsparker API documentation](https://www.netsparker.com/documentation/) for detailed information on endpoints and parameters.
- **Permissions:** Ensure you have appropriate permissions to perform actions such as starting scans, retrieving results, and generating reports.