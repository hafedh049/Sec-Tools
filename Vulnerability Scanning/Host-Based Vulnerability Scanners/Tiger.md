**Tiger** is a Unix-based security auditing tool designed to help system administrators assess their systems' security by scanning for vulnerabilities and potential configuration issues. It performs a variety of security checks on the system and provides recommendations for improving security.

Here's a guide for using Tiger with its command-line options and examples.

---

### **Tiger CLI Commands and Options**

#### **1. Running a Basic Security Audit**

1. **Basic Audit of the Local System:**
   - **Description:** This command runs a basic security audit of the local machine.
   - **Command:**
     ```bash
     tiger
     ```
   - **Example:**
     ```bash
     sudo tiger
     ```

   - **Explanation:** 
     - This will run Tiger's default set of security checks on the local system.

2. **Audit and Save Results to a Specific File:**
   - **Description:** Save the audit results to a custom file for later review.
   - **Command:**
     ```bash
     tiger > /path/to/output/file
     ```
   - **Example:**
     ```bash
     sudo tiger > /var/log/tiger_results.txt
     ```

   - **Explanation:** 
     - Redirects the output of Tiger's scan to the specified log file.

#### **2. Using Custom Configuration Files**

1. **Run Tiger with a Custom Configuration File:**
   - **Description:** Specify a custom configuration file instead of using the default one.
   - **Command:**
     ```bash
     tiger -c /path/to/config/file
     ```
   - **Example:**
     ```bash
     sudo tiger -c /etc/tiger/tigerrc
     ```

   - **Explanation:** 
     - This allows for a custom scan using different settings, specified in the configuration file.

#### **3. Running Specific Modules**

1. **Run a Specific Module (e.g., Check Password Security):**
   - **Description:** Tiger uses modules for different security checks. This command runs a specific module, like password checks.
   - **Command:**
     ```bash
     tiger -e passwd
     ```
   - **Example:**
     ```bash
     sudo tiger -e passwd
     ```

   - **Explanation:** 
     - The `-e` flag runs specific Tiger modules like `passwd`, which checks the password-related security aspects of the system.

2. **Run Multiple Specific Modules:**
   - **Description:** Specify multiple modules to run during a scan.
   - **Command:**
     ```bash
     tiger -e module1,module2,module3
     ```
   - **Example:**
     ```bash
     sudo tiger -e file,rc,system
     ```

   - **Explanation:** 
     - This command runs the `file`, `rc`, and `system` modules together to check file permissions, RC configuration files, and system security.

#### **4. Adjusting Logging and Output Settings**

1. **Log Results to a Specific Directory:**
   - **Description:** Specify a directory where Tiger will store all logs and results.
   - **Command:**
     ```bash
     tiger -l /path/to/log/directory
     ```
   - **Example:**
     ```bash
     sudo tiger -l /var/log/tiger_logs/
     ```

   - **Explanation:** 
     - The `-l` flag specifies the directory for saving all Tiger logs and outputs.

2. **Enable Verbose Output:**
   - **Description:** Display more detailed output during the scan.
   - **Command:**
     ```bash
     tiger -v
     ```
   - **Example:**
     ```bash
     sudo tiger -v
     ```

   - **Explanation:** 
     - This command enables verbose output, providing more detailed information about each check during the scan.

#### **5. Scheduling and Automating Audits**

1. **Automate a Regular Tiger Scan Using Cron:**
   - **Description:** Schedule regular Tiger audits using cron.
   - **Command:**
     ```bash
     crontab -e
     ```
   - **Example (inside cron job):**
     ```bash
     0 3 * * 1 /usr/sbin/tiger > /var/log/tiger_cron_log.txt
     ```

   - **Explanation:** 
     - This will run Tiger every Monday at 3 AM and store the results in the specified log file.

#### **6. Updating Tiger’s Database**

1. **Update the Tiger Security Database:**
   - **Description:** Update Tiger’s internal databases (such as checks for known vulnerabilities).
   - **Command:**
     ```bash
     tiger -u
     ```
   - **Example:**
     ```bash
     sudo tiger -u
     ```

   - **Explanation:** 
     - The `-u` flag updates the database, ensuring Tiger has the latest information for performing accurate checks.

#### **7. Running Integrity Checks**

1. **Run File Integrity Checks:**
   - **Description:** Use Tiger to perform file integrity checks to detect unauthorized changes to important files.
   - **Command:**
     ```bash
     tiger -e file
     ```
   - **Example:**
     ```bash
     sudo tiger -e file
     ```

   - **Explanation:** 
     - The `file` module checks the integrity of system files, verifying whether any important files have been altered.

#### **8. Checking for Security Alerts**

1. **Run Checks for Security Alerts (CERT Database):**
   - **Description:** Run Tiger to check for system vulnerabilities based on the latest CERT security alerts.
   - **Command:**
     ```bash
     tiger -e alerts
     ```
   - **Example:**
     ```bash
     sudo tiger -e alerts
     ```

   - **Explanation:** 
     - This command checks the system for vulnerabilities that correspond to the latest alerts from the CERT database.

#### **9. Advanced Options**

1. **Run Tiger in Debug Mode:**
   - **Description:** Run Tiger with debug information, useful for troubleshooting issues with the tool itself.
   - **Command:**
     ```bash
     tiger -d
     ```
   - **Example:**
     ```bash
     sudo tiger -d
     ```

   - **Explanation:** 
     - The `-d` flag runs Tiger in debug mode, providing additional information about the scan and any errors encountered.

2. **Get Help Information:**
   - **Description:** Display Tiger's help and available options.
   - **Command:**
     ```bash
     tiger -h
     ```
   - **Example:**
     ```bash
     tiger -h
     ```

   - **Explanation:** 
     - The `-h` flag displays help and usage information.

#### **10. Viewing Scan Results**

1. **View Detailed Results After a Scan:**
   - **Description:** After completing a scan, view the generated logs to examine the system's security status.
   - **Command:**
     ```bash
     cat /var/log/tiger/security.report.<hostname>.<date>
     ```
   - **Example:**
     ```bash
     cat /var/log/tiger/security.report.myserver.2023-08-20
     ```

   - **Explanation:** 
     - After running a scan, Tiger generates a detailed report in the `/var/log/tiger/` directory. This command displays the results of the security audit.

---

### **Example Scenarios**

1. **Example of Running a Full Audit and Saving the Results:**
   - **Command:**
     ```bash
     sudo tiger > /var/log/tiger_full_audit.txt
     ```

   - **Explanation:** 
     - This runs a complete system audit and saves the results to a log file for later review.

2. **Example of Running Integrity Checks and Password Checks Only:**
   - **Command:**
     ```bash
     sudo tiger -e file,passwd > /var/log/tiger_integrity_password.txt
     ```

   - **Explanation:** 
     - This checks file integrity and password security and saves the output in a log file.

3. **Example of Automating a Weekly Scan Using Cron:**
   - **Cron Command:**
     ```bash
     0 2 * * 7 /usr/sbin/tiger -v > /var/log/tiger_weekly.txt
     ```

   - **Explanation:** 
     - This schedules a weekly Tiger audit on Sunday at 2 AM and stores the output in a log file.

---

### **Usage Notes:**
- **Custom Configuration:** You can tailor Tiger's security checks to suit your system by editing the configuration files under `/etc/tiger/`.
- **Modules:** Tiger modules cover a wide range of checks, from file permissions to security alerts. You can select which modules to run depending on the scope of your audit.
- **Logs:** Tiger produces detailed logs that can be used for forensic analysis in case of security incidents.

Tiger is a flexible and powerful tool for performing security audits on Unix-like systems, helping to identify vulnerabilities and improve system hardening. Let me know if you need more details on any specific features!
